<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø´Ø§Øª Ø¹Ø§Ù…</title>
<style>
body { background:#111; color:white; font-family:sans-serif; padding:20px; }
#chat { height:400px; overflow:auto; border:1px solid #333; padding:10px; margin-bottom:10px; }
input { width:100%; padding:10px; margin-top:5px; box-sizing:border-box; border-radius:4px; border:none; }
.msg { margin:4px 0; }
.name { color:#4fc3f7; font-weight:bold; }
</style>
</head>
<body>

<h2>ðŸ’¬ Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¹Ø§Ù…</h2>
<div id="chat"></div>

<input id="name" placeholder="Ø§Ø³Ù…Ùƒ">
<input id="msg" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø© ÙˆØ§Ø¶ØºØ· Enter">

<script type="module">
  // Import Firebase SDK
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-analytics.js";

  // Firebase config (Ø¹Ø¨ÙŠØªÙ‡Ø§ Ù…Ù† Ø­Ø³Ø§Ø¨Ùƒ)
  const firebaseConfig = {
    apiKey: "AIzaSyDdbUK04WTiBvv3z1K9oYhssfpJTI9fZh4",
    authDomain: "chatdoy.firebaseapp.com",
    databaseURL: "https://chatdoy-default-rtdb.firebaseio.com",
    projectId: "chatdoy",
    storageBucket: "chatdoy.firebasestorage.app",
    messagingSenderId: "922018470576",
    appId: "1:922018470576:web:bbe06151c06e345c4cb975",
    measurementId: "G-6V7VB06ZPL"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const db = getDatabase(app);
  const chatRef = ref(db, "messages");

  const chat = document.getElementById("chat");
  const msg = document.getElementById("msg");
  const name = document.getElementById("name");

  // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
  msg.addEventListener("keydown", e => {
    if(e.key === "Enter" && msg.value.trim()){
      push(chatRef, {
        name: name.value || "Ø²Ø§Ø¦Ø±",
        text: msg.value,
        time: Date.now()
      });
      msg.value = "";
    }
  });

  // Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØ¹Ø±Ø¶Ù‡Ø§
  onChildAdded(chatRef, snap => {
    const d = snap.val();
    const div = document.createElement("div");
    div.className = "msg";
    div.innerHTML = `<span class="name">${d.name}:</span> ${d.text}`;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
  });
</script>

</body>
</html>
